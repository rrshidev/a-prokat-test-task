## Цель

Создать приложение на NestJS с двумя модулями:

1. BpiumModule: Отвечает за интеграцию с CRM через библиотеку bp-api (без контроллеров).
    
2. CarsModule: Управляет каталогом автомобилей с REST-эндпоинтами и интеграцией WebSocket.
    
## Требования

- **Технологический стек**: Node.js, NestJS, TypeScript
    
- **Внешняя библиотека**: bp-api (библиотека для работы с API CRM)
    
- **Модули**:
    
    - BpiumModule: Сервисный слой для интеграции с Bpium.
        
    - CarsModule: Управление каталогом автомобилей с REST-эндпоинтами и уведомлениями через WebSocket.
        
### Детали задания

1. **Настройка проекта**:
    
    - Инициализируйте новый проект NestJS.
        
    - Установите зависимости: @nestjs/config, typeorm, @nestjs/websockets, bp-api, class-validator, class-transformer.
        
2. **BpiumModule**:
	- Заведите бесплатный облачный Бипиум - https://bpium.ru/.
    - Создайте модуль BpiumModule для интеграции с Bpium.
    - Создайте каталог "Авто" с двумя полями - текстовое поле "название", поле типа "статус", где есть два значения "работает" и "не работает".
    - Создайте 4 записи авто, где есть авто, которые и работают, и не работают.
    - Контроллеры для этого модуля не требуются.
    - Настройте переменные окружения с помощью @nestjs/config:
        
        - BP_DOMAIN (например, https://crm.example.com)
            
        - BP_LOGIN
            
        - BP_PASSWORD
    - **Подсказка**: Для BpiumModule используйте наследование от bp-api в сервисном слое. Для CarsModule используйте @nestjs/websockets для работы с сокетами.
3. **CarsModule**:
    
    - Создайте модуль CarsModule для управления каталогом автомобилей.
        
    - Определите сущность Car с полями:
        
        - id: Автогенерируемый номер
            
        - title: Строка (название автомобиля)
            
        - isActive: Булево значение (true — работает, false — не работает).
            
    - Реализуйте CarsService для бизнес-логики и CarsController для REST-эндпоинтов.
        
    - Интегрируйте WebSocket с использованием @nestjs/websockets для отправки событий.
        
4. **Эндпоинты CarsModule**:
	- Всё взаимодействие с сущностью должно быть реализовано средствами API бипиума и библиотеки bp-api.
    - Реализуйте следующие REST-эндпоинты в CarsController:
        
        1. Возвращает список автомобилей, у которых статус равен "работает".
            
        2. Возвращает автомобиль по ID. Если автомобиль не работает (isActive: false), выбросить правильную ошибку.
            
        3. Создает новый автомобиль. Принимает JSON с полем title. По умолчанию создаёт автомобиль, который работает. Валидируйте, что title — непустая строка.
            
        4. Обновляет title и/или isActive автомобиля по ID. Валидируйте входные данные.
            
        5. **GET /cars/notify**: Запускает событие WebSocket (например, { event: 'car_notification', data: 'Notification triggered' }).
            
    - Используйте class-validator для валидации входных данных, где это применимо.
    - Используйте методы в REST-API и входящие в них данные верно.
        
5. **Интеграция WebSocket**:
    
    - Реализуйте шлюз WebSocket в CarsModule (например, CarsGateway).
        
    - При вызове эндпоинта GET /cars/notify отправляйте событие WebSocket всем подключенным клиентам.
        
 6. **Результаты**:
    
    - Полный исходный код приложения NestJS.
        
    - Пример файла .env с необходимыми переменными окружения.
        
    - README с описанием:
        
        - Как запустить проект (npm install, npm run start:dev).
            
        - Как протестировать REST-эндпоинты (например, с помощью Postman или cURL).
            
        - Как протестировать события WebSocket (например, с помощью клиента Socket.IO или инструмента wscat).
            

## Критерии оценки

- **Качество кода**: Чистый, модульный, хорошо задокументированный код с правильным использованием TypeScript.
    
- **Лучшие практики NestJS**: Корректное использование модулей, сервисов, контроллеров, внедрения зависимостей и декораторов.
    
- **BpiumModule**: Правильная интеграция с bp-api через наследование сервиса и настройку конфигурации.
    
- **CarsModule**: Корректная реализация всех эндпоинтов, сущности и функциональности WebSocket.
    
- **Валидация**: Корректная валидация входных данных с использованием class-validator.
    
- **Обработка ошибок**: Грамотная обработка некорректных входных данных, отсутствующих ресурсов и ошибок API.
    
- **WebSocket**: Функциональная отправка событий, вызываемая через эндпоинт уведомления.
    

## Пример .env.example

```
BP_DOMAIN=https://crm.example.com
BP_LOGIN=your_login
BP_PASSWORD=your_password
DATABASE_URL=sqlite::memory:
```

## Подача

- Предоставьте репозиторий на GitHub или ZIP-архив с проектом.
    
- Включите инструкции по запуску приложения и тестированию эндпоинтов/WebSocket.
    
- Убедитесь, что файл .env.example включен.